name: Flutter Diagnostics

on:
  workflow_dispatch:

jobs:
  diagnose:
    runs-on: ubuntu-latest  # Usamos Ubuntu primero para pruebas r√°pidas
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: 'stable'
    
    - name: Diagnostic information
      run: |
        echo "=== System Information ==="
        uname -a
        echo ""
        
        echo "=== Directory Structure ==="
        pwd
        ls -la
        echo ""
        
        echo "=== Flutter Version ==="
        flutter --version
        echo ""
        
        echo "=== Flutter Doctor ==="
        flutter doctor
        echo ""
        
        echo "=== Check iOS folder ==="
        if [ -d "ios" ]; then
          echo "iOS folder exists"
          ls -la ios/
        else
          echo "iOS folder does NOT exist"
        fi
        echo ""
        
        echo "=== Check pubspec.yaml ==="
        if [ -f "pubspec.yaml" ]; then
          echo "pubspec.yaml exists"
          head -20 pubspec.yaml
        else
          echo "ERROR: No pubspec.yaml found!"
        fi
'@ | Out-File -FilePath ".github\workflows\diagnose.yml" -Encoding UTF8